(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[913],{6191:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},30229:(e,t,r)=>{Promise.resolve().then(r.bind(r,50268))},50268:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var a=r(95155),s=r(12115),l=r(52619),c=r.n(l),i=r(86651),n=r(6191),d=r(57828),o=r(15239),h=r(95704);function u(){let[e,t]=(0,s.useState)([]),[r,l]=(0,s.useState)([]),[u,m]=(0,s.useState)(""),[x,f]=(0,s.useState)(!1),[p,y]=(0,s.useState)(null),[g,w]=(0,s.useState)(!1),v=h.env.NEXT_PUBLIC_API_URL||"";async function j(e){try{let e=await fetch("https://driveeasy.pythonanywhere.com/api/v1/car/{id}");if(!e.ok)throw Error("Failed to fetch car details");let t=await e.json();y(t),w(!0)}catch(e){console.error("Error fetching single car:",e)}}async function b(e){if(confirm("Are you sure you want to delete this car?"))try{if(!(await fetch("https://driveeasy.pythonanywhere.com/api/v1/car/".concat(e,"/delete/"),{method:"DELETE"})).ok)throw Error("Failed to delete car");t(t=>t.filter(t=>t.id!==e)),l(t=>t.filter(t=>t.id!==e)),alert("Car deleted successfully!")}catch(e){console.error("Error deleting car:",e),alert("An error occurred while deleting the car.")}}async function N(r){try{let a="available"===r.status?"unavailable":"available";if(!(await fetch("https://driveeasy.pythonanywhere.com/api/v1/car/".concat(r.id,"/update/"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:a})})).ok)throw Error("Failed to update car status");let s=e.map(e=>e.id===r.id?{...e,status:a}:e);t(s),l(s)}catch(e){console.error("Error updating car:",e),alert("Error updating car status.")}}return(0,s.useEffect)(()=>{!async function(){f(!0);try{let e=await fetch("https://driveeasy.pythonanywhere.com/api/v1/car/");if(!e.ok)throw Error("Failed to fetch reservations");let r=await e.json(),a=Array.isArray(r.results)?r.results:[],s=(await Promise.all(a.map(async e=>{try{let t=await fetch("https://driveeasy.pythonanywhere.com/api/v1/car/{id}".concat(e.car,"/"));if(!t.ok)throw Error("Failed to fetch car");return{...await t.json(),status:e.status}}catch(t){return console.error("Error fetching car ".concat(e.car,":"),t),null}}))).filter(e=>null!==e);t(s),l(s)}catch(e){console.error("Error fetching cars:",e)}finally{f(!1)}}()},[v]),(0,s.useEffect)(()=>{""===u.trim()?l(e):l(e.filter(e=>{var t;return null==(t=e.name)?void 0:t.toLowerCase().includes(u.toLowerCase())}))},[u,e]),(0,a.jsxs)("div",{className:"p-6 bg-gray-100 min-h-screen",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6",children:[(0,a.jsxs)("div",{className:"relative w-full sm:w-1/2 mb-4 sm:mb-0",children:[(0,a.jsx)("input",{type:"text",placeholder:"Search cars...",value:u,onChange:e=>m(e.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-full focus:outline-none focus:ring-2 focus:ring-green-500"}),(0,a.jsx)(i.A,{className:"absolute left-3 top-2.5 text-gray-500",size:18})]}),(0,a.jsxs)(c(),{href:"/dashboard/cars-listings/add",className:"flex items-center bg-black text-white px-4 py-2 rounded-full hover:bg-gray-800 transition",children:[(0,a.jsx)(n.A,{size:18,className:"mr-1"})," Add Car"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-t-lg shadow p-3 flex justify-between items-center font-semibold text-gray-600",children:[(0,a.jsx)("div",{className:"w-1/4",children:"Image"}),(0,a.jsx)("div",{className:"w-1/4",children:"Car Name"}),(0,a.jsx)("div",{className:"w-1/4",children:"Availability"}),(0,a.jsx)("div",{className:"w-1/4 text-right",children:"Price per Day"})]}),(0,a.jsx)("div",{className:"bg-white shadow rounded-b-lg divide-y divide-gray-200",children:x?(0,a.jsx)("div",{className:"text-center text-gray-500 py-8",children:"Loading cars..."}):r.length>0?r.map(e=>(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between p-3",children:[(0,a.jsx)("div",{className:"w-full sm:w-1/4 flex justify-center",children:(0,a.jsx)(o.default,{src:e.photo||"/placeholder-car.png",alt:e.name,height:64,width:96,className:"w-24 h-16 object-cover rounded"})}),(0,a.jsxs)("div",{className:"w-full sm:w-1/4 text-center font-medium",children:[e.name||"Unnamed"," ",(0,a.jsxs)("span",{className:"text-gray-500 text-sm",children:["(",e.model,")"]})]}),(0,a.jsx)("div",{className:"w-full sm:w-1/4 text-center",children:(0,a.jsx)("button",{onClick:()=>N(e),className:"px-3 py-1 rounded-full text-sm font-semibold ".concat("available"===e.status?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:"available"===e.status?"Available":"Unavailable"})}),(0,a.jsxs)("div",{className:"w-full sm:w-1/4 flex flex-col sm:flex-row justify-end gap-3 items-center mt-2 sm:mt-0",children:[(0,a.jsxs)("span",{className:"font-semibold",children:["$",e.price_per_day||0]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>j(e.id),className:"bg-gray-200 text-gray-800 px-3 py-1 rounded hover:bg-gray-300 transition flex items-center gap-1",children:[(0,a.jsx)(d.A,{size:14})," View"]}),(0,a.jsx)(c(),{href:"/dashboard/cars-listings/".concat(e.id,"/update"),className:"bg-black text-white px-3 py-1 rounded hover:bg-gray-800 transition",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>b(e.id),className:"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 transition",children:"Remove"})]})]})]},e.id)):(0,a.jsx)("div",{className:"text-center text-gray-500 py-8",children:"No cars found."})}),g&&p&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-[90%] max-w-lg relative",children:[(0,a.jsx)("button",{onClick:()=>w(!1),className:"absolute top-2 right-2 text-gray-500 hover:text-black",children:"âœ•"}),(0,a.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:[p.name," (",p.model,")"]}),(0,a.jsx)(o.default,{src:p.photo||"/placeholder-car.png",alt:p.name,height:160,width:240,className:"w-full h-40 object-cover rounded mb-4"}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Year:"})," ",p.year]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Type:"})," ",p.car_type]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Fuel:"})," ",p.fuel_type]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Wheel Drive:"})," ",p.wheel_drive]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Rules:"})," ",p.rules||"N/A"]})]})})]})}},57828:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},86651:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])}},e=>{e.O(0,[473,619,441,255,358],()=>e(e.s=30229)),_N_E=e.O()}]);